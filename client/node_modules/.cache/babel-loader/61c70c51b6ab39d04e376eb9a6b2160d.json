{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Zobrist/Desktop/Code/krown_clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/Zobrist/Desktop/Code/krown_clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signupWithEmailandPwd),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signinAfterSignup),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signinWithGoogle),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(signinWithEmailandPwd),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(signUserOut),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSigninStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onSignupStart),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignupSuccess),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onStartUserSignout),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from\"redux-saga/effects\";import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from\"../../firebase/firebase.utils\";import UserActionTypes from\"./user.types\";import{signinSuccess,signupSuccess,signoutSuccess,signinFailure,signupFailure,signoutFailure}from'./user.actions';export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signinSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signinFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);};export function signupWithEmailandPwd(_ref){var _ref$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signupWithEmailandPwd$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password,displayName=_ref$payload.displayName;console.log('ive been called');_context2.prev=2;_context2.next=5;return auth.createUserWithEmailAndPassword(email,password);case 5:_yield$auth$createUse=_context2.sent;user=_yield$auth$createUse.user;_context2.next=9;return put(signupSuccess({user:user,additionalData:{displayName:displayName}}));case 9:_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);_context2.next=15;return put(signupFailure(_context2.t0));case 15:case\"end\":return _context2.stop();}}},_marked2,null,[[2,11]]);};export function signinAfterSignup(_ref2){var _ref2$payload,user,additionalData;return _regeneratorRuntime.wrap(function signinAfterSignup$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref2$payload=_ref2.payload,user=_ref2$payload.user,additionalData=_ref2$payload.additionalData;_context3.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context3.stop();}}},_marked3);};export function signinWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signinWithGoogle$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context4.sent;user=_yield$auth$signInWit.user;_context4.next=7;return getSnapshotFromUserAuth(user);case 7:_context4.next=13;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);_context4.next=13;return put(signinFailure(_context4.t0));case 13:case\"end\":return _context4.stop();}}},_marked4,null,[[0,9]]);};export function signinWithEmailandPwd(_ref3){var _ref3$payload,email,password,displayName,_yield$auth$signInWit2,user,userRef,userSnapshot;return _regeneratorRuntime.wrap(function signinWithEmailandPwd$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_ref3$payload=_ref3.payload,email=_ref3$payload.email,password=_ref3$payload.password,displayName=_ref3$payload.displayName;_context5.prev=1;_context5.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context5.sent;user=_yield$auth$signInWit2.user;_context5.next=8;return call(createUserProfileDocument,user);case 8:userRef=_context5.sent;_context5.next=11;return userRef.get();case 11:userSnapshot=_context5.sent;_context5.next=14;return put(signinSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 14:_context5.next=19;break;case 16:_context5.prev=16;_context5.t0=_context5[\"catch\"](1);put(signinFailure(_context5.t0));case 19:case\"end\":return _context5.stop();}}},_marked5,null,[[1,16]]);};export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signinFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);};export function signUserOut(){return _regeneratorRuntime.wrap(function signUserOut$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return auth.signOut();case 3:_context7.next=5;return put(signoutSuccess());case 5:_context7.next=11;break;case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](0);_context7.next=11;return put(signoutFailure(_context7.t0));case 11:case\"end\":return _context7.stop();}}},_marked7,null,[[0,7]]);};// **__**__** SAGA GENERATOR LISTENERS **__**__** \\\\\nexport function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signinWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);};export function onEmailSigninStart(){return _regeneratorRuntime.wrap(function onEmailSigninStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signinWithEmailandPwd);case 2:case\"end\":return _context9.stop();}}},_marked9);};export function onSignupStart(){return _regeneratorRuntime.wrap(function onSignupStart$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signupWithEmailandPwd);case 2:case\"end\":return _context10.stop();}}},_marked10);};export function onSignupSuccess(){return _regeneratorRuntime.wrap(function onSignupSuccess$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signinAfterSignup);case 2:case\"end\":return _context11.stop();}}},_marked11);};export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context12.stop();}}},_marked12);};export function onStartUserSignout(){return _regeneratorRuntime.wrap(function onStartUserSignout$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signUserOut);case 2:case\"end\":return _context13.stop();}}},_marked13);};export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSigninStart),call(onCheckUserSession),call(onStartUserSignout),call(onSignupStart),call(onSignupSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);};","map":{"version":3,"sources":["/Users/Zobrist/Desktop/Code/krown_clothing/client/src/redux/user/user.sagas.js"],"names":["getSnapshotFromUserAuth","signupWithEmailandPwd","signinAfterSignup","signinWithGoogle","signinWithEmailandPwd","isUserAuthenticated","signUserOut","onGoogleSignInStart","onEmailSigninStart","onSignupStart","onSignupSuccess","onCheckUserSession","onStartUserSignout","userSagas","takeLatest","put","all","call","auth","googleProvider","createUserProfileDocument","getCurrentUser","UserActionTypes","signinSuccess","signupSuccess","signoutSuccess","signinFailure","signupFailure","signoutFailure","userAuth","additionalData","userRef","get","userSnapshot","id","data","payload","email","password","displayName","console","log","createUserWithEmailAndPassword","user","signInWithPopup","signInWithEmailAndPassword","signOut","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","SIGN_UP_START","SIGN_UP_SUCCESS","CHECK_USER_SESSION","SIGN_OUT_START"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from \"redux-saga/effects\";\n\nimport {\n  auth,\n  googleProvider,\n  createUserProfileDocument,\n  getCurrentUser\n  \n} from \"../../firebase/firebase.utils\";\n\nimport UserActionTypes from \"./user.types\";\nimport {\n  signinSuccess,\n  signupSuccess,\n  signoutSuccess,\n  signinFailure,\n  signupFailure,\n  signoutFailure,\n} from './user.actions';\n\n\n\nexport function* getSnapshotFromUserAuth(userAuth, additionalData) {\n  try {\n    const userRef = yield call(\n      createUserProfileDocument,\n      userAuth,\n      additionalData\n    );\n    const userSnapshot = yield userRef.get();\n    yield put(signinSuccess({ id: userSnapshot.id, ...userSnapshot.data() }));\n  } catch (error) {\n    yield put(signinFailure(error));\n  }\n};\n\n\n\nexport function* signupWithEmailandPwd({ payload: { email, password, displayName } }) {\n  console.log('ive been called')\n  try {\n    const { user } = yield auth.createUserWithEmailAndPassword(\n      email,\n      password\n    );\n    yield put(signupSuccess({ user, additionalData: { displayName } }));\n  }\n  catch (error) {\n    yield put(signupFailure(error))\n  }\n};\n\n\n\nexport function* signinAfterSignup({ payload: { user, additionalData } }) {\n  yield getSnapshotFromUserAuth(user, additionalData);\n};\n\n\n\nexport function* signinWithGoogle() {\n  try {\n    const { user } = yield auth.signInWithPopup(googleProvider);\n    yield getSnapshotFromUserAuth(user);\n  } catch (error) {\n    yield put(signinFailure(error));\n  }\n};\n\nexport function* signinWithEmailandPwd({ payload: { email, password, displayName  } }) {\n  try {\n    const { user } = yield auth.signInWithEmailAndPassword(email, password);\n    const userRef = yield call(createUserProfileDocument, user);\n    const userSnapshot = yield userRef.get();\n\n    yield put(\n     signinSuccess({ id: userSnapshot.id, ...userSnapshot.data() })\n    )\n  }\n  catch (error) {\n    put(signinFailure(error))\n  }\n};\n\nexport function* isUserAuthenticated() {\n  try{\n    const userAuth = yield getCurrentUser();\n    if(!userAuth) return;\n    yield getSnapshotFromUserAuth(userAuth);\n  }catch (error){\n    yield put(signinFailure(error));\n  }\n};\n\nexport function* signUserOut() {\n  try {\n    yield auth.signOut();\n    yield put(signoutSuccess());\n  } catch (error) {\n    yield put(signoutFailure(error));\n  }\n};\n\n// **__**__** SAGA GENERATOR LISTENERS **__**__** \\\\\nexport function* onGoogleSignInStart() {\n  yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signinWithGoogle);\n}; \nexport function* onEmailSigninStart() {\n  yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signinWithEmailandPwd)\n};\nexport function* onSignupStart() {\n  yield takeLatest(UserActionTypes.SIGN_UP_START, signupWithEmailandPwd);\n};\nexport function* onSignupSuccess() {\n  yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS, signinAfterSignup);\n};\nexport function* onCheckUserSession() {\n  yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated)\n};\nexport function* onStartUserSignout() {\n  yield takeLatest(UserActionTypes.SIGN_OUT_START, signUserOut)\n};\nexport function* userSagas() {\n  yield all([\n    call(onGoogleSignInStart),\n    call(onEmailSigninStart),\n    call(onCheckUserSession),\n    call(onStartUserSignout),\n    call(onSignupStart),\n    call(onSignupSuccess)\n  ]);\n};"]},"metadata":{},"sourceType":"module"}